<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Green Taxi Visualizations</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
    }
    .chart-title {
      font-size: 20px;
      margin: 20px 0 10px;
    }
    .bar {
      fill: steelblue;
    }
    .bar.weekend {
      fill: orange;
    }
    .axis-label {
      font-size: 12px;
    }
    .line {
      fill: none;
      stroke: steelblue;
      stroke-width: 2;
    }
  </style>
</head>
<body>
  <h1>Green Taxi NYC - 2023 Visualizations</h1>
  <div class="chart-title">A. Corridas por Dia da Semana</div>
  <svg id="chartA" width="700" height="400"></svg>

  <div class="chart-title">B. Gorjeta Média por Horário</div>
  <svg id="chartB" width="700" height="400"></svg>

  <script>
    // Dados simulados para fins de protótipo
    const dayData = [
      { day: 'Domingo', value: 12000 },
      { day: 'Segunda', value: 25000 },
      { day: 'Terça', value: 26000 },
      { day: 'Quarta', value: 25500 },
      { day: 'Quinta', value: 27000 },
      { day: 'Sexta', value: 24000 },
      { day: 'Sábado', value: 15000 },
    ];

    const tipData = Array.from({ length: 24 }, (_, i) => ({
      hour: i,
      tip: Math.round((Math.sin(i / 3) + 1.5) * 2 + Math.random() * 1.5)
    }));

    // Gráfico A - Barras
    const svgA = d3.select("#chartA"),
      margin = { top: 20, right: 30, bottom: 50, left: 60 },
      width = +svgA.attr("width") - margin.left - margin.right,
      height = +svgA.attr("height") - margin.top - margin.bottom;

    const gA = svgA.append("g").attr("transform", `translate(${margin.left},${margin.top})`);

    const xA = d3.scaleBand().domain(dayData.map(d => d.day)).range([0, width]).padding(0.2);
    const yA = d3.scaleLinear().domain([0, d3.max(dayData, d => d.value)]).nice().range([height, 0]);

    gA.append("g").call(d3.axisLeft(yA));
    gA.append("g").attr("transform", `translate(0,${height})`).call(d3.axisBottom(xA));

    gA.selectAll(".bar")
      .data(dayData)
      .enter()
      .append("rect")
      .attr("class", d => d.day === 'Sábado' || d.day === 'Domingo' ? "bar weekend" : "bar")
      .attr("x", d => xA(d.day))
      .attr("y", d => yA(d.value))
      .attr("width", xA.bandwidth())
      .attr("height", d => height - yA(d.value));

    // Gráfico B - Linha
    const svgB = d3.select("#chartB");
    const gB = svgB.append("g").attr("transform", `translate(${margin.left},${margin.top})`);

    const xB = d3.scaleLinear().domain([0, 23]).range([0, width]);
    const yB = d3.scaleLinear().domain([0, d3.max(tipData, d => d.tip)]).nice().range([height, 0]);

    const line = d3.line()
      .x(d => xB(d.hour))
      .y(d => yB(d.tip));

    gB.append("g").call(d3.axisLeft(yB));
    gB.append("g")
      .attr("transform", `translate(0,${height})`)
      .call(d3.axisBottom(xB).ticks(24).tickFormat(d => d + 'h'));

    gB.append("path")
      .datum(tipData)
      .attr("class", "line")
      .attr("d", line);

  </script>
</body>
</html>
